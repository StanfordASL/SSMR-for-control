function dJ = mvdP_dxdp(x, p)

x1 = x(1,:);
p1 = p(1,:);
p2 = p(2,:);
p4 = p(4,:);

dJ = zeros(3,3,4,numel(x1));
dJ(1,1,1,:) = (p4*(x1.^2-1)+1./p2)./p1.^2;
dJ(1,1,2,:) = 1./p1./p2.^2;
dJ(3,1,2,:) = -1./p2.^2;
dJ(1,1,4,:) = (1-x1.^2)./p1;
dJ(1,2,1,:) = 1./p1.^2;
dJ(1,3,1,:) = -1./p1.^2./p2;
dJ(1,3,2,:) = -1./p1./p2.^2;
dJ(3,3,2,:) = 1./p2.^2;

end
