function J = mvdP_dp(x, p)

x1 = x(1,:);
x2 = x(2,:);
x3 = x(3,:);
p1 = p(1,:);
p2 = p(2,:);
p4 = p(4,:);

J = zeros(3,4,numel(x1));
J(1,1,:) = (p4.*(x1.^3/3-x1) - (x3-x1)./p2 + x2)./p1.^2;
J(1,2,:) = (x1-x3)./p1./p2.^2;
J(3,2,:) = (x3-x1)./p2.^2;
J(2,3,:) = -1;
J(1,4,:) = (x1-x1.^3/3)./p1;

end
